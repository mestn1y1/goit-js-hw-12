{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-function.js","../src/js/pixabay-api.js","../src/js/loadMoreFunction.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\n\nexport function renderImgCard(images) {\n  const galleryList = document.querySelector('.gallery');\n  galleryList.innerHTML = '';\n  const markup = images\n    .map(\n      ({ largeImageURL, webformatURL, likes, views, comments, downloads }) =>\n        `\n      <li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"\" class=\"card-img\"/>\n        </a>\n        <ul class=\"galery-item-description\">\n          <li>\n            <p class=\"count-text\">Likes</p>\n            <p class=\"count\">${likes}</p>\n          </li>\n          <li>\n            <p class=\"count-text\">Views</p>\n            <p class=\"count\">${views}</p>\n          </li>\n          <li>\n            <p class=\"count-text\">Comments</p>\n            <p class=\"count\">${comments}</p>\n          </li>\n          <li>\n            <p class=\"count-text\">Downloads</p>\n            <p class=\"count\">${downloads}</p>\n          </li>\n        </ul>\n      </li>\n      `\n    )\n    .join('');\n\n  galleryList.insertAdjacentHTML('afterbegin', markup);\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n","// export async function getPicturesByQuery(query) {\n//   const API_KEY = '44784729-ebc9a0f5cc587c2700d41657d';\n//   const imageType = 'photo';\n//   const orientation = 'horizontal';\n//   const safeSearch = true;\n\n//   const url = `https://pixabay.com/api/?key=${API_KEY}&q=${query}&image_type=${imageType}&orientation=${orientation}&safesearch=${safeSearch}`;\n\n//   try {\n//     const res = await fetch(url);\n\n//     if (!res.ok) {\n//       throw new Error(res.status);\n//     }\n//     return await res.json();\n//   } catch (error) {\n//     throw new Error(error.message);\n//   }\n// }\nimport axios from 'axios';\n\nexport async function getPicturesByQuery(query, page) {\n  const params = {\n    key: '44784729-ebc9a0f5cc587c2700d41657d',\n    q: query,\n    imageType: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 15,\n  };\n\n  const url = 'https://pixabay.com/api/';\n\n  try {\n    const response = await axios.get(url, { params });\n\n    if (response.status !== 200) {\n      throw new Error(`Request failed with status ${response.status}`);\n    }\n\n    return response.data;\n  } catch (error) {\n    throw new Error(error.message);\n  }\n}\n","const hiddenClass = 'is-hidden';\n\nfunction hide(button) {\n  button.classList.add(hiddenClass);\n}\nfunction show(button) {\n  button.classList.remove(hiddenClass);\n}\nfunction disable(button, spinner) {\n  button.disabled = true;\n  spinner.classList.remove(hiddenClass);\n}\nfunction enable(button, spinner) {\n  button.disabled = false;\n  spinner.classList.add(hiddenClass);\n}\n\nexport default { hide, show, disable, enable };\n","import iziToast from 'izitoast';\nimport { renderImgCard } from './js/render-function.js';\nimport { getPicturesByQuery } from './js/pixabay-api.js';\nimport loadMoreFunction from './js/loadMoreFunction.js';\n\nconst searchForm = document.querySelector('.search-form');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.button');\nconst spinner = document.querySelector('.spinner');\nlet query = '';\nlet page = 1; // Початкова сторінка\n\nsearchForm.addEventListener('submit', handlerSearch);\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  maxPage: 0,\n};\n\nloadMoreFunction.hide(loadMoreBtn);\n\nasync function handlerSearch(evt) {\n  evt.preventDefault();\n\n  const form = evt.currentTarget;\n  query = form.elements.query.value.trim().toLowerCase(); // Оновлюємо глобальну змінну query\n\n  if (!query) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query.',\n      position: 'topRight',\n      timeout: 2000,\n    });\n    return;\n  }\n  page = 1; // Скидаємо сторінку до початкового значення\n  showLoader();\n  loadMoreFunction.show(loadMoreBtn);\n  loadMoreFunction.disable(loadMoreBtn, spinner);\n\n  try {\n    const { hits, total } = await getPicturesByQuery(query, page);\n    // розрахунок максимальної сторінки\n    params.maxPage = Math.ceil(total / params.per_page);\n\n    console.log(params.maxPage);\n\n    if (hits.length === 0) {\n      iziToast.warning({\n        title: 'Warning',\n        message: 'Nothing found for your request.',\n        position: 'topRight',\n        timeout: 2000,\n      });\n    } else {\n      renderImgCard(hits);\n    }\n\n    console.log(hits, total);\n\n    // Перевірка, чи потрібно показувати кнопку \"Завантажити ще\"\n    if (hits.length !== total) {\n      loadMoreFunction.enable(loadMoreBtn, spinner);\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    } else {\n      loadMoreFunction.hide(loadMoreBtn);\n    }\n  } catch (error) {\n    onFetchError(error);\n  } finally {\n    hideLoader();\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1; // Збільшуємо сторінку для наступного запиту\n  loadMoreFunction.disable(loadMoreBtn, spinner);\n\n  try {\n    const { hits } = await getPicturesByQuery(query, page); // Використовуємо оновлене значення query і page\n\n    // Малюємо нові зображення\n    renderImgCard(hits);\n  } catch (err) {\n    console.log(err);\n  } finally {\n    loadMoreFunction.enable(loadMoreBtn, spinner);\n\n    // Перевіряємо, чи досягли максимальної сторінки\n    if (page === params.maxPage) {\n      loadMoreFunction.hide(loadMoreBtn);\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n    }\n  }\n}\n\nfunction onFetchError(err) {\n  console.error('Fetch Error:', err);\n  hideLoader();\n}\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n"],"names":["renderImgCard","images","galleryList","markup","largeImageURL","webformatURL","likes","views","comments","downloads","SimpleLightbox","getPicturesByQuery","query","page","params","url","response","axios","error","hiddenClass","hide","button","show","disable","spinner","enable","loadMoreFunction","searchForm","loader","loadMoreBtn","handlerSearch","evt","form","iziToast","showLoader","hits","total","handleLoadMore","onFetchError","hideLoader","err"],"mappings":"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"}